@{
    ViewData["Title"] = "Separando Instrumentos...";
    var folderName = ViewBag.FolderName as string;
}

<h2>🎧 Separando instrumentos do áudio...</h2>
<p>Aguarde enquanto realizamos a separação. Isso pode levar até 2 minutos.</p>

<div style="margin-top: 20px;">
    <img src="https://i.gifer.com/YCZH.gif" alt="Carregando..." width="100" />
</div>

<script>
    const folder = "@folderName";

    const verificar = () => {
        fetch(`/Music/VerificarArquivosSeparados?folderName=${folder}`)
            .then(res => res.json())
            .then(data => {
                if (data.completo) {
                    window.location.href = "/Music";
                } else {
                    setTimeout(verificar, 3000); // tenta novamente em 3s
                }
            })
            .catch(() => setTimeout(verificar, 3000)); // se falhar, tenta de novo
    };

    verificar();
</script>
